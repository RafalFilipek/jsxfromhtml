{"version":3,"sources":["../src/index.js"],"names":["JsxHtml","state","content","setHtmlProp","mounted","setContent","prevProps","oldHtml","pickHtml","newHtml","props","html","setState","mapElements","mapInline","mapBlock","children","displayName","propTypes","string","object","oneOfType","func","defaultProps"],"mappings":";;;;;;;;AAEA;;;;AAEA;;AAEA;;;;;;;;;;;;IAUMA,O;;;;;;;;;;;;;;wLAqBJC,K,GAAQ;AACNC,eAAS,IADH;AAENC,mBAAa;AAFP,K,QAKRC,O,GAAU,K;;;;;wCAEU;AAClB,WAAKA,OAAL,GAAe,IAAf;AACA,WAAKC,UAAL;AACD;;;uCAEkBC,S,EAAkB;AACnC,UAAMC,UAAUP,QAAQQ,QAAR,CAAiBF,SAAjB,CAAhB;AACA,UAAMG,UAAUT,QAAQQ,QAAR,CAAiB,KAAKE,KAAtB,CAAhB;AACA,UAAID,YAAYF,OAAhB,EAAyB;AACvB,YAAI,KAAKG,KAAL,CAAWC,IAAX,IAAmB,CAAC,KAAKV,KAAL,CAAWE,WAAnC,EAAgD;AAC9C,eAAKS,QAAL,CAAc,EAAET,aAAa,IAAf,EAAd;AACD;AACD,aAAKE,UAAL;AACD;AACF;;;2CAEsB;AACrB,WAAKD,OAAL,GAAe,KAAf;AACD;;;iCAYY;AACX,UAAMO,OAAOX,QAAQQ,QAAR,CAAiB,KAAKE,KAAtB,CAAb;AACA,UAAMR,UAAU,uBACdS,QAAQ,EADM,EAEd,KAAKD,KAAL,CAAWG,WAFG,EAGd,KAAKH,KAAL,CAAWI,SAHG,EAId,KAAKJ,KAAL,CAAWK,QAJG,CAAhB;AAMA,UAAI,KAAKX,OAAT,EAAkB;AAChB,aAAKQ,QAAL,CAAc,EAAEV,gBAAF,EAAd;AACD;AACF;;;6BAEQ;AACP,aAAO,OAAO,KAAKQ,KAAL,CAAWM,QAAlB,KAA+B,UAA/B,GACH,KAAKN,KAAL,CAAWM,QAAX,CAAoB,KAAKf,KAAL,CAAWC,OAA/B,CADG,GAEH,KAAKD,KAAL,CAAWC,OAFf;AAGD;;;6BA3BeQ,K,EAAgB;AAC9B,UAAIA,MAAMC,IAAV,EAAgB;AACd,eAAOD,MAAMC,IAAb;AACD;AACD,UAAI,OAAOD,MAAMM,QAAb,KAA0B,QAA9B,EAAwC;AACtC,eAAON,MAAMM,QAAb;AACD;AACD,aAAO,IAAP;AACD;;;;;;AAxDGhB,O,CACGiB,W,GAAc,S;AADjBjB,O,CAKGkB,S,GAAY;AACjBP,QAAM,oBAAUQ,MADC;AAEjBN,eAAa,oBAAUO,MAFN;AAGjBN,aAAW,oBAAUO,SAAV,CAAoB,CAAC,oBAAUF,MAAX,EAAmB,oBAAUG,IAA7B,CAApB,CAHM;AAIjBP,YAAU,oBAAUM,SAAV,CAAoB,CAAC,oBAAUF,MAAX,EAAmB,oBAAUG,IAA7B,CAApB,CAJO;AAKjBN,YAAU,oBAAUK,SAAV,CAAoB,CAAC,oBAAUF,MAAX,EAAmB,oBAAUG,IAA7B,CAApB;AALO,C;AALftB,O,CAaGuB,Y,GAAsB;AAC3BZ,QAAM,EADqB;AAE3BE,eAAa,EAFc;AAG3BC,aAAW,EAHgB;AAI3BC,YAAU,EAJiB;AAK3BC,YAAU;AALiB,C;kBAiEhBhB,O","file":"index.js","sourcesContent":["// @flow\n\nimport PropTypes from 'prop-types';\n\nimport { PureComponent } from 'react';\n\nimport convert from './convert';\n\ntype Props = {\n  html: string,\n  mapElements?: { [key: string]: any },\n  mapInline?: string | Function,\n  mapBlock?: string | Function,\n  children?: Function | null\n};\n\nclass JsxHtml extends PureComponent {\n  static displayName = 'JsxHtml';\n\n  props: Props;\n\n  static propTypes = {\n    html: PropTypes.string,\n    mapElements: PropTypes.object,\n    mapInline: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n    mapBlock: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n    children: PropTypes.oneOfType([PropTypes.string, PropTypes.func])\n  };\n\n  static defaultProps: Props = {\n    html: '',\n    mapElements: {},\n    mapInline: '',\n    mapBlock: '',\n    children: null\n  };\n\n  state = {\n    content: null,\n    setHtmlProp: false\n  };\n\n  mounted = false;\n\n  componentDidMount() {\n    this.mounted = true;\n    this.setContent();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    const oldHtml = JsxHtml.pickHtml(prevProps);\n    const newHtml = JsxHtml.pickHtml(this.props);\n    if (newHtml !== oldHtml) {\n      if (this.props.html && !this.state.setHtmlProp) {\n        this.setState({ setHtmlProp: true });\n      }\n      this.setContent();\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  static pickHtml(props: JsxHtml) {\n    if (props.html) {\n      return props.html;\n    }\n    if (typeof props.children === 'string') {\n      return props.children;\n    }\n    return null;\n  }\n\n  setContent() {\n    const html = JsxHtml.pickHtml(this.props);\n    const content = convert(\n      html || '',\n      this.props.mapElements,\n      this.props.mapInline,\n      this.props.mapBlock\n    );\n    if (this.mounted) {\n      this.setState({ content });\n    }\n  }\n\n  render() {\n    return typeof this.props.children === 'function'\n      ? this.props.children(this.state.content)\n      : this.state.content;\n  }\n}\n\nexport default JsxHtml;\n"]}